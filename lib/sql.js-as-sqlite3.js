!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).sqlJsAsSqlite3={})}(this,(function(e){"use strict";var t=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var u,c,f=this._events[a],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(e,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,t),!0;case 3:return f.fn.call(f.context,t,r),!0;case 4:return f.fn.call(f.context,t,r,o),!0;case 5:return f.fn.call(f.context,t,r,o,i),!0;case 6:return f.fn.call(f.context,t,r,o,i,s),!0}for(c=1,u=new Array(l-1);c<l;c++)u[c-1]=arguments[c];f.fn.apply(f.context,u)}else{var p,v=f.length;for(c=0;c<v;c++)switch(f[c].once&&this.removeListener(e,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,t);break;case 3:f[c].fn.call(f[c].context,t,r);break;case 4:f[c].fn.call(f[c].context,t,r,o);break;default:if(!u)for(p=1,u=new Array(l-1);p<l;p++)u[p-1]=arguments[p];f[c].fn.apply(f[c].context,u)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var u=0,c=[],f=a.length;u<f;u++)(a[u].fn!==t||o&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[i]=1===c.length?c[0]:c:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}));function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:String(t)}function i(e,t,n){return t=u(t),s(e,a()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function s(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function a(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(a=function(){return!!e})()}function u(e){return u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},u(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}var f={};function l(e){var t=e.initSqlJs,n=e.wasmFileBaseUrl;f.initSqlJs=t,f.wasmFileBaseUrl=n}var p=function(e){function t(e,n,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=i(this,t),"function"==typeof n&&(r=n,n=void 0);var a=function(e){r(e)},u=f.wasmFileBaseUrl||("undefined"!=typeof window?window.SQL_JS_WASM_FILE_BASE_URL:void 0),c="undefined"!=typeof process&&"node"===process.release.name,l=function(e){r?a(e):o.emit("error",e)};if(!c){if(!u)return s(o,l(new Error("The base URL for `sql.js` `*.wasm` files is not configured")));if("/"!==u[u.length-1])return s(o,l(new Error('The base URL for `sql.js` `*.wasm` files must end with a "/"')))}return(f.initSqlJs?Promise.resolve(f.initSqlJs):c?import("sql.js").then((function(e){return e.default})):"undefined"!=typeof window?Promise.resolve(window.initSqlJs):Promise.reject(new Error("`window` is not defined"))).then((function(e){return e?e({locateFile:c?void 0:function(e){return"".concat(u).concat(e)}}).then((function(e){o.database=new e.Database,o.emit("open"),r&&a(null)}),l):l(new Error("`sql.js` not found"))}),l),o}var n,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(t,e),n=t,o=[{key:"close",value:function(e){this.database.close(),this.emit("close"),e&&e(null)}},{key:"configure",value:function(e,t){}},{key:"loadExtension",value:function(e,t){throw new Error("`loadExtension()` is not supported")}},{key:"interrupt",value:function(){}},{key:"wait",value:function(e){e&&e(null)}},{key:"serialize",value:function(e){e()}},{key:"parallelize",value:function(e){e()}},{key:"run",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=y(n),i=o.query,s=o.callback,a=o.parameters,u={},c=s;c&&(c=c.bind(u));try{this.database.run(i,a);var f=/^\s*insert\s+/i.test(i),l=/^\s*update\s+/i.test(i),p=/^\s*delete\s+/i.test(i),v=function(t){return e.database.exec(t+";")[0].values[0][0]};f&&(u.lastID=v("select last_insert_rowid()")),(f||l||p)&&(u.changes=v("select changes()")),c&&h(c,null)}catch(e){c?h(c,e):this.emit("error",e)}return this}},{key:"all",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=y(t),o=r.query,i=r.callback,s=r.parameters;try{var a=[];this.database.each(o,s,(function(e){a.push(e)}),(function(){i&&h(i,null,a)}))}catch(e){if(!i)throw e;h(i,e)}return this}},{key:"each",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=y(t),o=r.query,i=r.callback,s=r.parameters;try{this.database.each(o,s,(function(e){i&&h(i,null,e)}))}catch(e){if(!i)throw e;h(i,e)}return this}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=y(t),o=r.query,i=r.callback,s=r.parameters;try{var a=this.database.exec(o,s)[0];i&&h(i,null,a)}catch(e){if(!i)throw e;h(i,e)}return this}},{key:"exec",value:function(e,t){try{this.database.exec(e),t&&h(t,null)}catch(e){t?h(t,e):this.emit("error",e)}return this}},{key:"prepare",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=y(t),o=r.query,i=r.callback,s=r.parameters,a={};try{a=this.database.prepare(o,s),i&&h(i,null)}catch(e){if(!i)throw e;h(i,e)}return a}}],o&&r(n.prototype,o),a&&r(n,a),Object.defineProperty(n,"prototype",{writable:!1}),t}(t),v=function(){if("undefined"!=typeof process&&"function"==typeof process.nextTick)return function(e){process.nextTick(e)};var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",(function(e){var t=e.source;t!==window&&null!==t||"process-tick"!==e.data||(e.stopPropagation(),n.length>0&&n.shift()())}),!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}();function h(e,t,n){v((function(){return e(t,n)}))}function y(e){var t,r,o=e.shift();return 0===e.length?t=[]:("function"==typeof e[e.length-1]&&(r=e.pop()),t=e),1===t.length&&null!==t[0]&&"object"===n(t[0])&&(t=t[0]),{query:o,parameters:t,callback:r}}function d(){var e={Database:p,verbose:function(){return e}};return e}var w={Database:p,verbose:d,configure:l};e.Database=p,e.configure=l,e.default=w,e.verbose=d,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sql.js-as-sqlite3.min.js.map
